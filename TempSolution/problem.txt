ストーリー

APPLE ARTIS社（通称 AA社）は、りんごの大量生産を生業とする企業である。このたび、長年の研究の成果により、無からりんごを生み出す革新的な機械の開発に成功した。

しかし、この機械を用いてりんごを本格的に大量生産するには、機械そのものを大量に生産する必要がある。そこでAA社は、りんご生産機を生産するための機械生産機、さらにその機械生産機を生産するための機械生産機生産機、というように階層的に機械を生み出す仕組みを構築した。

AA社のエンジニアであるあなたは、これらの階層的な機械群を活用し、できるだけ多くのりんごを生産するための生産計画アルゴリズムを構築する任務を任された。

問題文

𝑁
N 種類のIDと 
𝐿
L 種類のLevelからなる 
𝑁
×
𝐿
N×L 種類の機械が存在し、Levelが 
𝑖
i、IDが 
𝑗
j の機械を機械 
𝑗
𝑖
j
i
 と呼ぶ（
0
≤
𝑖
<
𝐿
,
 
0
≤
𝑗
<
𝑁
0≤i<L, 0≤j<N）。

機械 
𝑗
0
j
0
 の生産能力は 
𝐴
𝑗
A
j
	​

 である。また、機械 
𝑗
𝑖
j
i
 の初期コストは 
𝐶
𝑖
,
𝑗
C
i,j
	​

 である。

以下の生産計画の手順に従い、全 
𝑇
T ターン終了時点でのりんごの総数を最大化することが目的である。

生産計画の手順

機械 
𝑗
𝑖
j
i
 の個数を 
𝐵
𝑖
,
𝑗
B
i,j
	​

 とし、計画開始時点ではすべて 
1
1 である。 また、機械 
𝑗
𝑖
j
i
 のパワーを 
𝑃
𝑖
,
𝑗
P
i,j
	​

 とし、開始時点ではすべて 
0
0 である。

計画開始時点でのりんごの数は 
𝐾
K である。 各ターンは以下の手順で進行する。

あなたは以下の2つの行動のうちいずれか1つを選択する。
機械 
𝑗
𝑖
j
i
 を強化する：りんごを 
𝐶
𝑖
,
𝑗
×
(
𝑃
𝑖
,
𝑗
+
1
)
C
i,j
	​

×(P
i,j
	​

+1) 消費し、
𝑃
𝑖
,
𝑗
P
i,j
	​

 を1増やす。ただし、りんごの数が負になるような強化は行えない。
何もしない。
Level 0, 1, 2, 3 の順に、すべての機械 
𝑗
𝑖
j
i
 について以下の処理を行う。
Level 0 の機械（
𝑖
=
0
i=0）の場合：
りんごを 
𝐴
𝑗
×
𝐵
𝑖
,
𝑗
×
𝑃
𝑖
,
𝑗
A
j
	​

×B
i,j
	​

×P
i,j
	​

 増加させる。
Level 1 以上の機械（
𝑖
≥
1
i≥1）の場合：
𝐵
𝑖
−
1
,
𝑗
B
i−1,j
	​

 を 
𝐵
𝑖
,
𝑗
×
𝑃
𝑖
,
𝑗
B
i,j
	​

×P
i,j
	​

 増加させる。

上手に行動を選択し、
𝑇
T ターン終了時点でのりんごの数をできるだけ多くしてほしい。

得点

𝑇
T ターン後の時点におけるりんごの数を 
𝑆
S としたとき、
r
o
u
n
d
(
1
0
5
×
log
⁡
2
𝑆
)
round(10
5
×log
2
	​

S) の得点が得られる。 得点は大きいほど良い。

以下の場合、WAとなる。

りんごの数が 
0
0 未満になるような強化を行った場合
存在しない機械のLevelまたはIDを指定した場合
行動回数が 
𝑇
T 未満の場合

合計で 150 個のテストケースがあり、各テストケースの得点の合計が提出の得点となる。 一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定がWAやTLEとなる。 コンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 同じ得点を複数の参加者が得た場合、提出時刻に関わらず同じ順位となる。

入力

入力は以下の形式で標準入力から与えられる。

𝑁
N 
𝐿
L 
𝑇
T 
𝐾
K

𝐴
0
A
0
	​

 
𝐴
1
A
1
	​

 
⋯
⋯ 
𝐴
𝑁
−
1
A
N−1
	​



𝐶
0
,
0
C
0,0
	​

 
𝐶
0
,
1
C
0,1
	​

 
⋯
⋯ 
𝐶
0
,
𝑁
−
1
C
0,N−1
	​



𝐶
1
,
0
C
1,0
	​

 
𝐶
1
,
1
C
1,1
	​

 
⋯
⋯ 
𝐶
1
,
𝑁
−
1
C
1,N−1
	​



⋮
⋮

𝐶
𝐿
−
1
,
0
C
L−1,0
	​

 
𝐶
𝐿
−
1
,
1
C
L−1,1
	​

 
⋯
⋯ 
𝐶
𝐿
−
1
,
𝑁
−
1
C
L−1,N−1
	​



1行目には、4つの整数 
𝑁
,
𝐿
,
𝑇
,
𝐾
N,L,T,K が与えられる。
𝑁
N は機械のIDの種類数であり、
𝑁
=
10
N=10 を満たす。
𝐿
L は機械のLevelの種類数であり、
𝐿
=
4
L=4 を満たす。
𝑇
T は総ターン数であり、
𝑇
=
500
T=500 を満たす。
𝐾
K は計画開始時点のりんごの数であり、
𝐾
=
1
K=1 を満たす。
2行目には、Level 0 の機械の生産能力を表す 
𝑁
N 個の整数 
𝐴
0
,
𝐴
1
,
…
,
𝐴
𝑁
−
1
A
0
	​

,A
1
	​

,…,A
N−1
	​

 が空白区切りで与えられる。
𝐴
𝑗
A
j
	​

 は機械 
𝑗
0
j
0
 の生産能力であり、
1
≤
𝐴
𝑗
≤
100
1≤A
j
	​

≤100 を満たす。
𝐴
A は昇順にソートされている（
𝐴
0
≤
𝐴
1
≤
⋯
≤
𝐴
𝑁
−
1
A
0
	​

≤A
1
	​

≤⋯≤A
N−1
	​

）。
続く 
𝐿
L 行には、それぞれ 
𝑁
N 個の整数 
𝐶
𝑖
,
𝑗
C
i,j
	​

 が空白区切りで与えられる。
𝐶
𝑖
,
𝑗
C
i,j
	​

 は機械 
𝑗
𝑖
j
i
 の初期コストであり、
1
≤
𝐶
𝑖
,
𝑗
≤
1.25
×
1
0
12
1≤C
i,j
	​

≤1.25×10
12
 を満たす。
出力

ちょうど 
𝑇
T 行出力せよ。 各行には、
𝑡
t ターン目（
0
≤
𝑡
<
𝑇
0≤t<T）に行う行動を、
0
0 ターン目から順に以下の形式で出力すること。

機械 
𝑗
𝑖
j
i
 を強化する場合
𝑖
i 
𝑗
j

何もしない場合
-1


解答プログラムは、# から始まるコメント行を出力に含めても良い。

例を見る

入力生成方法

𝐿
L 以上 
𝑈
U 以下の実数値を一様ランダムに生成する関数を 
r
a
n
d
_
d
o
u
b
l
e
(
𝐿
,
𝑈
)
rand_double(L,U) で表す。

𝐴
𝑗
A
j
	​

 の生成
𝑗
=
0
j=0 のとき：
𝐴
0
=
1
A
0
	​

=1
𝑗
≠
0
j

=0 のとき：
𝐴
𝑗
=
r
o
u
n
d
(
1
0
r
a
n
d
_
d
o
u
b
l
e
(
0
,
2
)
)
A
j
	​

=round(10
rand_double(0,2)
)
生成後、
𝐴
A 配列を昇順にソートする
𝐶
𝑖
,
𝑗
C
i,j
	​

 の生成
𝑖
=
0
i=0 かつ 
𝑗
=
0
j=0 のとき：
𝐶
0
,
0
=
1
C
0,0
	​

=1
それ以外のとき：
𝐶
𝑖
,
𝑗
=
r
o
u
n
d
(
𝐴
𝑗
×
50
0
𝑖
×
1
0
r
a
n
d
_
d
o
u
b
l
e
(
0
,
2
)
)
C
i,j
	​

=round(A
j
	​

×500
i
×10
rand_double(0,2)
)
ツール(入力ジェネレータ・ビジュアライザ)
Web版: ローカル版より高性能でアニメーション表示と手動プレイが可能です。
ローカル版: 使用するにはRust言語のコンパイル環境をご用意下さい。
Windows用のコンパイル済みバイナリ: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。

コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。